<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>CSAPP | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="2.2 Integer RepresentationDefinition of unsigned encodingFor vector $\vec{x}&#x3D;\left[x_{w-1}, x_{w-2}, \ldots, x_{0}\right]:$$$B 2 U_{w}(\vec{x}) \doteq \sum_{i&#x3D;0}^{w-1} x_{i} 2^{i}\(2.1)$$Definition of">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP">
<meta property="og:url" content="http://example.com/2021/04/06/CSAPP/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="2.2 Integer RepresentationDefinition of unsigned encodingFor vector $\vec{x}&#x3D;\left[x_{w-1}, x_{w-2}, \ldots, x_{0}\right]:$$$B 2 U_{w}(\vec{x}) \doteq \sum_{i&#x3D;0}^{w-1} x_{i} 2^{i}\(2.1)$$Definition of">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-04-05T14:15:14.000Z">
<meta property="article:modified_time" content="2021-04-22T15:32:43.471Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-CSAPP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/04/06/CSAPP/" class="article-date">
  <time datetime="2021-04-05T14:15:14.000Z" itemprop="datePublished">2021-04-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CSAPP
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="2-2-Integer-Representation"><a href="#2-2-Integer-Representation" class="headerlink" title="2.2 Integer Representation"></a>2.2 Integer Representation</h2><p><strong>Definition of unsigned encoding</strong><br>For vector $\vec{x}=\left[x_{w-1}, x_{w-2}, \ldots, x_{0}\right]:$<br>$$<br>B 2 U_{w}(\vec{x}) \doteq \sum_{i=0}^{w-1} x_{i} 2^{i}\<br>(2.1)<br>$$<br><strong>Definition of two’s-complement encoding</strong><br>For vector $\vec{x}=\left[x_{w-1}, x_{w-2}, \ldots, x_{0}\right]:$<br>$$<br>B 2 T_{w}(\vec{x}) \doteq-x_{w-1} 2^{w-1}+\sum_{i=0}^{w-2} x_{i} 2^{i}\<br>(2.3)<br>$$<br><strong>Combining equations 2.1 and 2.3</strong><br>$$<br>B2U_w - B2T = 2^w<br>$$<br><strong>Conversion from two’s complement to unsigned</strong><br>For $x$ such that $\operatorname{TMin}<em>{w} \leq x \leq \operatorname{TMax}</em>{w}$ :<br>$$<br>T 2 U_{w}(x)=\left{\begin{array}{ll}<br>x+2^{w}, &amp; x&lt;0 \<br>x, &amp; x \geq 0<br>\end{array}\right.\<br>(2.5)<br>$$<br>(Derivation: Compare equations 2.1 and 2.3)</p>
<p><strong>Unsigned to two’s-complement conversion</strong><br>For $u$ such that $0 \leq u \leq U M a x_{w}:$<br>$$<br>U 2 T_{w}(u)=\left{\begin{array}{ll}<br>u, &amp; u \leq \operatorname{TMax}<em>{w} \<br>u-2^{w}, &amp; u&gt;\operatorname{TMax}</em>{w}<br>\end{array}\right.\<br>(2.7)<br>$$<br><strong>More</strong><br>$$<br>B2U + |B2T| = 2^w<br>$$<br><strong>And more</strong></p>
<p>Umax -&gt; -1</p>
<p>Tmax+1 -&gt; Tmin</p>
<h3 id="Truncating-Numbers"><a href="#Truncating-Numbers" class="headerlink" title="Truncating Numbers"></a>Truncating Numbers</h3><p>When truncating a w-bit number to a k-bit number, we drop the high-order (w − k) bits.</p>
<p><strong>Truncation of an unsigned number</strong><br>$$<br>B2U_k = B2U_w ;mod; 2^k \<br>(2^i ;mod; 2^k = 0, i\ge k)<br>$$<br><strong>Truncation of a two’s complement number</strong><br>$$<br>B2T_k = U2T_k(B2U_w ;mod; 2^k)<br>$$</p>
<h3 id="Other-things"><a href="#Other-things" class="headerlink" title="Other things"></a>Other things</h3><h3 id="Unsigned-arithmetic-problems"><a href="#Unsigned-arithmetic-problems" class="headerlink" title="Unsigned arithmetic problems"></a>Unsigned arithmetic problems</h3><p>Implicit cast to unsigned numbers if there is an unsigned in the expression, then unsigned arithmetic, which is equivalent to modular addition.</p>
<p><strong>size_t</strong></p>
<p>Typically, it is defined to be unsigned for 32-bit programs and unsigned long for 64-bit programs.</p>
<h2 id="2-3-Integer-Arithmetic"><a href="#2-3-Integer-Arithmetic" class="headerlink" title="2.3 Integer Arithmetic"></a>2.3 Integer Arithmetic</h2><h3 id="2-3-1-Unsigned-Addition"><a href="#2-3-1-Unsigned-Addition" class="headerlink" title="2.3.1 Unsigned Addition"></a>2.3.1 Unsigned Addition</h3><p>Fixed-size arithmetic leads to different result from daily mathematics.</p>
<p><strong>Unsigned addition</strong></p>
<p>For x and y such that 0 ≤ x,y &lt; $2^w$:<br>$$<br>x+_{w}^{\mathrm{u}} y=\left{\begin{array}{ll}<br>x+y, &amp; x+y&lt;2^{w} \quad \text { Normal } \<br>x+y-2^{w}, &amp; 2^{w} \leq x+y&lt;2^{w+1} \quad \text { Overflow }<br>\end{array}\right.\<br>(2.11)<br>$$<br><strong>Detecting overflow of unsigned addition</strong></p>
<p>For x and y in the range 0 ≤ x,y ≤ $UMax_w$, let $s = x +^u_w y.$ Then the computation of s overflowed if and only if s&lt;x (or equivalently, s&lt;y).</p>
<p><strong>Abelian group</strong></p>
<p>Modular addition forms a mathematical structure known as an abelian group. That is, it is commutative and associative; it has an identity element 0, and every element has an additive inverse.</p>
<p>The expression (x+y)-x will evaluate to y regardless of whether or not the addition overflows, and that (x+y)-y will always evaluate to x</p>
<p><strong>Unsigned negation (Unsigned additive inverse)</strong></p>
<p>For any number $x$ such that $0 \leq x&lt;2^{w}$, its $w$ -bit unsigned negation $-{ }_{w}^{\mathrm{u}} x$ is given by the following:<br>$$<br>-_{w}^{\mathrm{u}} x=\left{\begin{array}{ll}<br>x, &amp; x=0 \<br>2^{w}-x, &amp; x&gt;0<br>\end{array}\right.\<br>(2.12)<br>$$<br>(Derivation: $-_w^u x +_w^u x = 0$)</p>
<h3 id="2-3-2-Two’s-Complement-Addition"><a href="#2-3-2-Two’s-Complement-Addition" class="headerlink" title="2.3.2 Two’s-Complement Addition"></a>2.3.2 Two’s-Complement Addition</h3><p><strong>Two’s-complement addition</strong></p>
<p>For integer values $x$ and $y$ in the range $-2^{w-1} \leq x, y \leq 2^{w-1}-1$ :<br>$$<br>x+_{w}^{\mathrm{t}} y=\left{\begin{array}{llc}<br>x+y-2^{w}, &amp; 2^{w-1} \leq x+y &amp; \text { Positive overflow } \<br>x+y, &amp; -2^{w-1} \leq x+y&lt;2^{w-1} &amp; \text { Normal } \<br>x+y+2^{w}, &amp; x+y&lt;-2^{w-1} &amp; \text { Negative overflow }<br>\end{array}\right.\<br>(2.13)<br>$$<br>Derivation:</p>
<p>Since two’s-complement addition has the exact same bit-level representation as unsigned addition, so:<br>$$<br>\begin{aligned}<br>x+<em>{w}^{\mathrm{t}} y &amp;=U 2 T</em>{w}\left(T 2 U_{w}(x)+<em>{w}^{\mathrm{u}} T 2 U</em>{w}(y)\right) \<br>&amp;=U 2 T_{w}\left[\left(x_{w-1} 2^{w}+x+y_{w-1} 2^{w}+y\right) \bmod 2^{w}\right] \<br>&amp;=U 2 T_{w}\left[(x+y) \bmod 2^{w}\right]<br>\end{aligned}<br>$$<br>According to the range of x+y, we have 4 cases, mapping to 3 cases in equation 2.13.</p>
<p><strong>Detecting overflow in two’s-complement addition</strong><br>For x and y in the range $TMin_w ≤ x,y ≤ TMax_w$, let $s = x +^t_w y$. Then the computation of s has had positive overflow if and only if x &gt; 0 and y &gt; 0 but s ≤ 0. The computation has had negative overflow if and only if x &lt; 0 and y &lt; 0 but s ≥ 0.</p>
<h3 id="2-3-3-Two’s-Complement-Negation"><a href="#2-3-3-Two’s-Complement-Negation" class="headerlink" title="2.3.3 Two’s-Complement Negation"></a>2.3.3 Two’s-Complement Negation</h3><p>For $x$ in the range $\operatorname{TMin}<em>{w} \leq x \leq \operatorname{TMax}</em>{w}$, its two’s-complement negation $-{ }<em>{w}^{t} x$ is given by the formula<br>$$<br>-</em>{w}^{\mathrm{t}} x=\left{\begin{array}{ll}<br>\operatorname{TMin}<em>{w}, &amp; x=\operatorname{TMin}</em>{w} \<br>-x, &amp; x&gt;\operatorname{TMin}<em>{w}<br>\end{array}\right.\<br>(2.15)<br>$$<br><strong>One technique</strong> for performing two’s-complement negation at the bit level is to complement the bits and then increment the result<br>$$<br>B 2 T</em>{w}(\sim \vec{x})=-\left(1-x_{w-1}\right) 2^{w-1}+\sum_{i=0}^{w-2}\left(1-x_{i}\right) 2^{i}\<br>\begin{aligned}<br>&amp;=\left[-2^{w-1}+\sum_{i=0}^{w-2} 2^{i}\right]-\left[-x_{w-1} 2^{w-1}+\sum_{i=0}^{w-2} x_{i} 2^{i}\right] \<br>&amp;=\left[-2^{w-1}+2^{w-1}-1\right]-B 2 T_{w}(\vec{x}) \<br>&amp;=-1-x<br>\end{aligned}<br>$$<br>Then, incrementing by 1 can be implemented this way:</p>
<ol>
<li>rightmost 0 -&gt; 1</li>
<li>1 bits at right of that 0 -&gt; 0</li>
</ol>
<p><strong>This technique above can be simplified to:</strong> </p>
<ol>
<li>find the right most 1</li>
<li>complement every bit on the left of that 1</li>
</ol>
<h3 id="2-3-4-Unsigned-Multiplication"><a href="#2-3-4-Unsigned-Multiplication" class="headerlink" title="2.3.4 Unsigned Multiplication"></a>2.3.4 Unsigned Multiplication</h3><p>For x and y such that $0 \le x, y \le UMax_w$:<br>$$<br>x *^u_w y = (x * y) ;mod; 2^w\<br>(2.16)<br>$$</p>
<h3 id="2-3-5-Two’s-complement-Multiplication"><a href="#2-3-5-Two’s-complement-Multiplication" class="headerlink" title="2.3.5 Two’s-complement Multiplication"></a>2.3.5 Two’s-complement Multiplication</h3><p>For x and y such that $TMin_w \le x,y \le TMax_w$:<br>$$<br>x <em>^t_w y = U2T_w((x</em>y) ;mod; 2^w)\<br>(2.17)<br>$$<br><strong>The bit-level representation of the product operation is identical for both unsigned and two’s-complement multiplication.</strong><br>$$<br>T2B_w(x <em>^t_w y) = U2B_w(x *^u_w y)<br>$$<br>*</em>Derivation:**</p>
<p>For  $x^{\prime}=x+x_{w-1} 2^{w}$ and $y^{\prime}=y+y_{w-1} 2^{w}$:<br>$$<br>\begin{aligned}<br>\left(x^{\prime} \cdot y^{\prime}\right) \bmod 2^{w} &amp;=\left[\left(x+x_{w-1} 2^{w}\right) \cdot\left(y+y_{w-1} 2^{w}\right)\right] \bmod 2^{w} \<br>&amp;=\left[x \cdot y+\left(x_{w-1} y+y_{w-1} x\right) 2^{w}+x_{w-1} y_{w-1} 2^{2 w}\right] \bmod 2^{w} \<br>&amp;=(x \cdot y) \bmod 2^{w}<br>\end{aligned}\<br>(2.18)\<br>T 2 U_{w}\left(x *<em>{w}^{\mathrm{t}} y\right)=T 2 U</em>{w}\left(U 2 T_{w}\left((x \cdot y) \bmod 2^{w}\right)\right)=(x \cdot y) \bmod 2^{w}\<br>U 2 B_{w}\left(T 2 U_{w}\left(x_{w}^{\mathrm{t}} y\right)\right)=T 2 B_{w}\left(x <em><em>{w}^{\mathrm{t}} y\right)=U 2 B</em>{w}\left(x^{\prime} *_{w}^{\mathrm{u}} y^{\prime}\right)<br>$$<br>*</em>The result of modular operation is always positive!**</p>
<p><strong>While I think, two’s-compliment multiplication is actually:</strong><br>$$<br>x *^t_w y = U2T(T2U(x) *^u_w T2U(x))<br>$$</p>
<h3 id="2-3-6-Multiplying-by-Constants"><a href="#2-3-6-Multiplying-by-Constants" class="headerlink" title="2.3.6 Multiplying by Constants"></a>2.3.6 Multiplying by Constants</h3><p>multiplication by power of 2 -&gt; left shift<br>$$<br>\begin{array}{l}<br>\text { Form } A:(x&lt;&lt;n)+(x&lt;&lt;(n-1))+\cdots+(x&lt;&lt;m) \<br>\text { Form B: } \quad(x&lt;&lt;(n+1))-(x&lt;&lt;m)<br>\end{array}<br>$$</p>
<h3 id="2-3-7-Dividing-by-Powers-of-2"><a href="#2-3-7-Dividing-by-Powers-of-2" class="headerlink" title="2.3.7 Dividing by Powers of 2"></a>2.3.7 Dividing by Powers of 2</h3><p>Integer division always rounds toward zero, while right shift always rounds down.</p>
<p><strong>Unsigned division by a power of 2</strong></p>
<p>Logical right shift k bits, yielding value of $\lfloor x / 2^k \rfloor$. It’s ok to rounds down, cause it’s equivalent to rounding toward zero when result is always positive. </p>
<p><strong>Two’s-complement division by a power of 2, rounding down</strong></p>
<p>Arithmetical right shift k bits, yielding value of $\lfloor x / 2^k \rfloor$, which violates rounding toward zero rules for integer division when result is negative. </p>
<p>Exploiting the property $\lceil x / y\rceil=\lfloor(x+y-1) / y\rfloor$, we write <code>(x+(1&lt;&lt;k)-1) &gt;&gt; k</code> to get $\lceil x/2^w \rceil$.</p>
<p>So for a two’s-complement machine using arithmetic right shifts, the C expression</p>
<p><code>(x&lt;0 ? x+(1&lt;&lt;k)-1 : x) &gt;&gt; k</code></p>
<p>will compute the value $x/2^w$.</p>
<h3 id="Problem-2-44"><a href="#Problem-2-44" class="headerlink" title="Problem 2.44"></a>Problem 2.44</h3><p>$$<br>\begin{aligned}<br>&amp;\text { G. } \mathrm{x} * \sim \mathrm{y}+\mathrm{uy} * \mathrm{ux}==-\mathrm{x}\<br>&amp;\text { True. } \sim \mathrm{y} \text { equals }-\mathrm{y}-1 . \text { uy*ux equals } \mathrm{x} * \mathrm{y} . \text { Thus, the left-hand side is equivalent }\<br>&amp;\text { to } x *-y-x+x * y<br>\end{aligned}<br>$$</p>
<ol>
<li>On the bit level, arithmetic of unsigned and two’s-complement values are indeed identical.</li>
<li>On the math level, math laws such as commutative and associative laws are also applicable. The only thing bit arithmetic differs from integer math is that it truncates numbers in every step of calculation. </li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/04/06/CSAPP/" data-id="cknt1p8y20001h0nc9hal7ooc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2021/01/07/Android-Studio%E5%A2%99%E5%86%85%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Android Studio墙内使用手册</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/06/CSAPP/">CSAPP</a>
          </li>
        
          <li>
            <a href="/2021/01/07/Android-Studio%E5%A2%99%E5%86%85%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/">Android Studio墙内使用手册</a>
          </li>
        
          <li>
            <a href="/2020/12/25/c/">c</a>
          </li>
        
          <li>
            <a href="/2020/10/28/Servlet%E5%B0%8F%E7%82%B9%E5%92%8C%E8%B8%A9%E5%9D%91/">Servlet踩坑</a>
          </li>
        
          <li>
            <a href="/2020/10/25/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">Java多线程</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>